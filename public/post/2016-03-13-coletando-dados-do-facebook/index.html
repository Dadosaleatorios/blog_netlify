<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.37.1" />

  <title>Coletando dados do Facebook &middot; Dados Aleatórios</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  

  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>Sobre</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/contact/"><i class='fa fa-phone fa-fw'></i>Contato</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/dadosaleatorios" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://facebook.com/dadosaleatorios" target="_blank"><i class="fa fa-facebook-square fa-fw"></i>Facebook</a>
    </li>
    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://instagram.com/*" target="_blank"><i class="fa fa-instagram fa-fw"></i>Instagram</a>
    </li>
    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/*" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/dadosaleatorios" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/*" target="_blank"><i class="fa fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2016. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Coletando dados do Facebook</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Mar 2016, 00:00</time>
  </div>

  

  

  

</div>

  

<p>Em nossas últimas postagens mostramos duas maneiras de extrair informações de sites: <a href="http://www.dadosaleatorios.com.br/2016/01/baixando-e-interpretando-sites-ou-como.html">através do código fonte do site, manipulando diretamente no R</a> e <a href="http://www.dadosaleatorios.com.br/2016/02/primeiros-contatos-com-o-rselenium.html">através do pacote RSelenium</a>. Nesta postagem falaremos uma terceira maneira: o uso de <a href="https://pt.wikipedia.org/wiki/Interface_de_programa%C3%A7%C3%A3o_de_aplica%C3%A7%C3%B5es">API</a>, exemplificando com a API do Facebook.</p>

<p>O Facebook permite que certos dados sejam coletados através da <a href="https://developers.facebook.com/docs/graph-api">Graph API</a>, permitindo com que a análise seja feita em qualquer linguagem de programação. O uso dela é bastante simples, bem documentado e possui um <a href="https://developers.facebook.com/tools/explorer/">ambiente de teste</a>, que permite formular e testar as querys a serem utilizadas. Agora, vamos aos exemplos!</p>

<h4 id="autenticação">Autenticação</h4>

<p>Antes de solicitar qualquer dado, obviamente você precisa se identificar, e a Graph API utiliza um token como autenticação. Para gerar ele, basta entrar na <a href="https://developers.facebook.com/tools/explorer/">Graph API Explorer</a> e clicar no botão &lsquo;Get Token&rsquo; =&gt; &lsquo;Get User Access Token&rsquo; e marcar as opções que você quer ter a API tenha acesso. Para os exemplos daqui, será necessário autorizar o acesso a &lsquo;user_posts&rsquo;</p>

<h4 id="exemplo-1-pegando-as-últimas-postagens">Exemplo 1: Pegando as últimas postagens</h4>

<p>Após a criação do token é bastante fácil obter informações. Por exemplo, para pegar as últimas 25 postagens o comando é (no final da postagem tem um link com o código comentado):</p>

<p><code>token &lt;- '' # Colar aqui o token!
readLines(sprintf(&quot;https://graph.facebook.com/v2.5/me/posts?access_token=%s&quot;, token)) # Ignorem a mensagem de warning</code></p>

<p>O resultado é uma única string formatada como [](<a href="https://pt.wikipedia.org/wiki/JSON)[](https://www.blogger.com/)[JSON](https://pt.wikipedia.org/wiki/JSON">https://pt.wikipedia.org/wiki/JSON)[](https://www.blogger.com/)[JSON](https://pt.wikipedia.org/wiki/JSON</a>), que pode ser interpretada com ajuda do comando fromJSON do pacote <a href="https://cran.r-project.org/web/packages/jsonlite/index.html">jsonlite</a>. É possível ver a estrutura do resultado através do comando str() - uma lista de tamanho 2, sendo a primeira (data) um data.frame com 4 variáveis (message, created_time, id e story) e a segunda (paging) uma lista com 2 elementos - os links para as páginas anteriores e seguintes.</p>

<p><code>fromJSON(readLines(sprintf(&quot;https://graph.facebook.com/v2.5/me/posts?access_token=%s&quot;, token)))
str(fromJSON(readLines(sprintf(&quot;https://graph.facebook.com/v2.5/me/posts?access_token=%s&quot;, token))))</code></p>

<p>No código disponibilizado no final da postagem há um exemplo de como pegar todas as suas postagens e estrutura-las em um data.table(), junto com alguns exemplos de estatísticas [básicas].</p>

<h4 id="exemplo-2-pegando-as-informações-comentários-curtidas-e-compartilhamentos-de-uma-postagem">Exemplo 2: Pegando as informações (comentários, curtidas e compartilhamentos) de uma postagem</h4>

<p>Assim como simples obter as postagens é simples, obter informações sobre uma postagem também é bastante fácil, basta saber qual o ID da postagem - um código numérico composto por duas partes: o id do autor e o id da postagem. Caso você tenha rodado o código anterior, o ID da postagem estará na coluna &lsquo;id&rsquo; do data.table</p>

<p><code>
id &lt;- 'xxx_yyy' # Colar aqui o id
fromJSON(readLines(sprintf(&quot;https://graph.facebook.com/v2.5/%s/?access_token=%s&quot;, id, token)))</code></p>

<p>Assim obtemos a data e conteúdo da postagem. Para pegar os comentários, curtidas e compartilhamentos, basta acrescentar comments, likes ou sharedposts antes do ?</p>

<p><code>fromJSON(readLines(sprintf(&quot;https://graph.facebook.com/v2.5/%s/?access_token=%s&quot;, id, token)))
fromJSON(readLines(sprintf(&quot;https://graph.facebook.com/v2.5/%s/comments?access_token=%s&quot;, id, token)))
fromJSON(readLines(sprintf(&quot;https://graph.facebook.com/v2.5/%s/likes?access_token=%s&quot;, id, token)))
fromJSON(readLines(sprintf(&quot;https://graph.facebook.com/v2.5/%s/sharedposts?access_token=%s&quot;, id, token)))</code></p>

<p>Novamente, o objeto retornado é uma lista de tamanho 2, com a mesma estrutura vista anteriormente - um elemento dos dados e outro elemento da paginação. Como geralmente as pessoas/desenvolvedores estão interessados apenas no número de curtidas/comentários/compartilhamentos, é possível pedir o número através do parâmetro summary:</p>

<p><code>fromJSON(readLines(sprintf(&quot;https://graph.facebook.com/v2.5/%s/likes?access_token=%s&amp;summary=true&quot;, id, token)))</code></p>

<h4 id="considerações-finais">Considerações finais</h4>

<p>Embora nossos exemplos tenham ficado apenas nas postagens do usuário, a API do Facebook permite coletar praticamente todas informações contidas no site, além de postar conteúdo. Outras redes sociais também possuem APIs (<a href="https://www.instagram.com/developer/">Instagram</a>, <a href="https://dev.twitter.com/">Twitter</a>), que serão temas de postagens aqui no blog. O código completo dos exemplos está no meu <a href="https://goo.gl/E2nHTI">GitHub</a>, junto com alguns exemplos que não foram utilizados na postagem - como uma wordcloud das postagens. Dúvidas? Sugestões? Deixe seu comentário!</p>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
    <a href="/post/2016-02-22-primeiros-contatos-com-o-rselenium/"><i class="fa fa-chevron-left"></i></a>
    
  </div>
  <div class="pure-u-10-24">
    
    <nav class="prev">
      <a href="/post/2016-02-22-primeiros-contatos-com-o-rselenium/">Primeiros contatos com o RSelenium</a>
    </nav>
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="/post/2016-09-14-lendo-arquivos-ofx-no-r/">Lendo arquivos OFX no R</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="/post/2016-09-14-lendo-arquivos-ofx-no-r/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="/js/ui.js"></script>






</body>
</html>

