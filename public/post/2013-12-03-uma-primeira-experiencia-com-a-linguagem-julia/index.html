<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.37.1" />

  <title>Uma primeira experiência com a linguagem Julia &middot; Dados Aleatórios</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

 
  

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon" />

  
  

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  

  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>Sobre</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/contact/"><i class='fa fa-phone fa-fw'></i>Contato</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/dadosaleatorios" target="_blank"><i class="fa fa-twitter-square fa-fw"></i>Twitter</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://facebook.com/dadosaleatorios" target="_blank"><i class="fa fa-facebook-square fa-fw"></i>Facebook</a>
    </li>
    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://instagram.com/*" target="_blank"><i class="fa fa-instagram fa-fw"></i>Instagram</a>
    </li>
    

    

    

    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/*" target="_blank"><i class="fa fa-linkedin-square fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/dadosaleatorios" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://stackoverflow.com/users/*" target="_blank"><i class="fa fa-stack-overflow fa-fw"></i>Stack Overflow</a>
    </li>
    

    

    

    

    

    

    

    

    

    

  </ul>
</div>


  <div>
  <div class="small-print">
    <small>&copy; 2016. All rights reserved.</small>
  </div>
  <div class="small-print">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Uma primeira experiência com a linguagem Julia</h1>
  <h2></h2>
</div>
<div class="content">

  <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>03 Dec 2013, 00:00</time>
  </div>

  

  

  

</div>

  <p>Imaginem a seguinte situação: Existe um grilo no jardim e o mesmo pula de forma aleatória. Basicamente ele escolhe um ângulo e pula. Escolhe outro ângulo e pula mais uma vez. E assim segue, até o momento que ele cansa. Desejamos responder a pergunta sobre qual a localização do grilo após os muitos pulos dados por ele.</p>

<p>Uma das muitas opções de resolver este problema (e acredito que a mais simples) é simular os respectivos pulos do grilo muitas vezes e ver onde foi a posição final. Simples assim.</p>

<p>Inicialmente foi implementada uma solução escrita em R, menos de 20 linhas, e como era de esperar, o desempenho não foi um dos pontos fortes (demorou cerca de 30 minutos). Então veio a assombrosa pergunta que paira a cabeça de</p>

<table cellpadding="0" style="float:right;margin-left:1em;text-align:center;" cellspacing="0" class="tr-caption-container" ><tbody ><tr >
<td style="text-align:center;" >

![](https://dadosaleatorios.files.wordpress.com/2013/12/caminhoaleatorio.png)

</td></tr><tr >
<td style="text-align:center;" class="tr-caption" >Um exemplo do grilo dando 5 pulos.
</td></tr></tbody></table>

<p>todos: Tem como fazer melhor? E é claro, a resposta é sim !</p>

<p>Sobre a implementação em si não teria muito o que mudar, afinal o código já não tinha nenhum <em>for</em> ou _while, _todas as operações ou eram vetoriais ou estavam sendo feitas com a utilização de funções de alta ordem (os famosos <em>applys</em>). Então tive a ideia de executar o código em paralelo, utilizando os muitos núcleos de um HPC (<em>High Performance Computer</em>) que tenho acesso. A adaptação foi relativamente simples, dado que o código já estava utilizando os _applys. _Tudo que tinha que ser feito era trocar o <em>lapply</em> por um _mclapply (_que faz parte do pacote _multicore). _Adaptações feitas. No meu modesto computador utilizando 4 cores, o código passou a demorar 17 minutos ! Bela melhora, pensei. O próximo passo foi executar o código diretamente no _HPC, <em>afinal lá</em> _teria acesso a 12 <em>cores</em>. O novo tempo? 5 minutos ! Surpreendente, pensei. Estava simulando 100.000 vezes o grilo pulando 1.000 vezes. Isto dá um total de 100 milhões de operações pelo menos. Então novamente veio a pergunta a cabeça: Dá para fazer melhor? Inicialmente pensei em implementar o problema utilizando Python, mas foi neste momento que lembrei da linguagem <a href="http://julialang.org/">Julia</a>, que era tão comentada por sua incrível performance em computação científica.</p>

<p>Acessei o site e comecei a ler a documentação. Não tinha muito o que fazer, ou aprender. Tinha um problema e tinha que resolvê-lo. Li o básico sobre criação e tipos de objetos e lá fui eu com a mão na massa. Após cerca de 3 horas, tinha terminado a implementação. Algo próximo de 40 linhas. Então chegou a hora da verdade. Executei esperando pelo menos os 5 minutos alcançados pelo R sendo executado em 12 cores. Me decepcionei, afinal demorou apenas 30 segundos !</p>

<p>Novamente veio a pergunta a cabeça: Dá para fazer melhor? Então comecei a implementação utilizando <em>Python</em>, apenas curiosidade. Após feito, lá estava o resultado: 200 segundos. Porém não parou por aí, afinal <em>Julia</em> utiliza um compilador JIT (<em>just-in-time</em>) . Resolvi reescrever o código em <em>Python</em> utilizando um JIT para <em>Python</em> que é o <a href="http://pypy.org/">pypy</a>. Então aí que veio a surpresa: 10 segundos. Sem dúvidas este é um belo tempo, comparado aos 30 minutos iniciais.</p>

<p>Apesar de ter conseguido tempos de execuções razoavelmente bons, a grande pergunta ainda martela a minha cabeça: <strong>Dá para fazer melhor?</strong> Provavelmente sim, em especial utilizando o R. Nas próximas semanas vou ver como posso melhorar o código, talvez utilizar um compilador JIT também ajude. Claro que não espero bater os 10 segundos do pypy, mas se fizer em menor de 1 minuto vai ser uma boa performance. Sobre a linguagem Julia, que bela impressão que tive, afinal sem fazer muitos esforços ou otimizar o código consegui 30 segundos executando em single core.</p>

<p>Bom, e para quem ficou curioso sobre a posição final do grilo, aqui vai um heatmap com a posição (x,y) e a freqûencia.</p>

<p><img src="https://dadosaleatorios.files.wordpress.com/2013/12/posicaofinal.png" alt="" /></p>

<dl>
<dt>Os códigos fontes nas diversas linguagens podem ser achados <a href="https://github.com/djongs/Grasshopper-Jumps">aqui</a>.</dt>
</dl>

<p>:)</p>


  
<div class="prev-next-post pure-g">
  <div class="pure-u-1-24" style="text-align: left;">
    
  </div>
  <div class="pure-u-10-24">
    
  </div>
  <div class="pure-u-2-24">
    &nbsp;
  </div>
  <div class="pure-u-10-24">
    
    <nav class="next">
      <a href="/post/2013-12-07-integrando-r-e-julia-em-um-mesmo-ambiente/">Integrando R e Julia em um mesmo ambiente</a>
    </nav>
    
  </div>
  <div class="pure-u-1-24" style="text-align: right;">
    
    <a href="/post/2013-12-07-integrando-r-e-julia-em-um-mesmo-ambiente/"><i class="fa fa-chevron-right"></i></a>
    
  </div>
</div>



  

</div>

</div>
</div>
<script src="/js/ui.js"></script>






</body>
</html>

